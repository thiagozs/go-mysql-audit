package main

import (
	"fmt"
	"strings"

	"github.com/mercadobitcoin/go-proxy-audit/utils"
)

func main() {

	// Parser header client for handshake
	handshake_client := []byte{74, 0, 0, 0, 10, 53, 46, 54, 46, 53, 49, 0, 15, 0, 0, 0, 110, 76, 113, 116, 114, 97, 108, 126, 0, 255, 247, 8, 2, 0, 127, 128, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 99, 119, 77, 89, 89, 52, 53, 79, 108, 83, 60, 0, 109, 121, 115, 113, 108, 95, 110, 97, 116, 105, 118, 101, 95, 112, 97, 115, 115, 119, 111, 114, 100, 0}

	// Handshake response without header
	handshake_client2 := []byte{13, 162, 191, 1, 0, 0, 0, 64, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 114, 111, 111, 116, 0, 0, 109, 101, 114, 99, 97, 100, 111, 98, 105, 116, 99, 111, 105, 110, 0, 99, 97, 99, 104, 105, 110, 103, 95, 115, 104, 97, 50, 95, 112, 97, 115, 115, 119, 111, 114, 100, 0, 86, 4, 95, 112, 105, 100, 5, 49, 52, 54, 50, 51, 3, 95, 111, 115, 8, 111, 115, 120, 49, 48, 46, 49, 53, 9, 95, 112, 108, 97, 116, 102, 111, 114, 109, 6, 120, 56, 54, 95, 54, 52, 15, 95, 99, 108, 105, 101, 110, 116, 95, 118, 101, 114, 115, 105, 111, 110, 6, 56, 46, 48, 46, 49, 50, 12, 95, 99, 108, 105, 101, 110, 116, 95, 110, 97, 109, 101, 8, 108, 105, 98, 109, 121, 115, 113, 108}

	// Raw handshake
	handshake_client3 := []byte{162, 0, 0, 1, 13, 162, 191, 1, 0, 0, 0, 64, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 114, 111, 111, 116, 0, 0, 109, 101, 114, 99, 97, 100, 111, 98, 105, 116, 99, 111, 105, 110, 0, 99, 97, 99, 104, 105, 110, 103, 95, 115, 104, 97, 50, 95, 112, 97, 115, 115, 119, 111, 114, 100, 0, 86, 4, 95, 112, 105, 100, 5, 49, 52, 54, 50, 51, 3, 95, 111, 115, 8, 111, 115, 120, 49, 48, 46, 49, 53, 9, 95, 112, 108, 97, 116, 102, 111, 114, 109, 6, 120, 56, 54, 95, 54, 52, 15, 95, 99, 108, 105, 101, 110, 116, 95, 118, 101, 114, 115, 105, 111, 110, 6, 56, 46, 48, 46, 49, 50, 12, 95, 99, 108, 105, 101, 110, 116, 95, 110, 97, 109, 101, 8, 108, 105, 98, 109, 121, 115, 113, 108}

	fmt.Printf("result client => %s\n", string(handshake_client))

	str, plen := utils.ParseStringNUL(handshake_client[32:])

	fmt.Printf("result => %s %d\n", str, plen)

	fmt.Printf(strings.Repeat("=", 80) + "\n")

	fmt.Printf("result2 client2 => %s\n", string(handshake_client2))

	str2, plen2 := utils.ParseStringNUL(handshake_client2[32:])

	fmt.Printf("result2 => %s %d\n", str2, plen2)

	fmt.Printf(strings.Repeat("=", 80) + "\n")

	fmt.Printf("result3 client3 => %s\n", string(handshake_client2))

	str3, plen3 := utils.ParseStringNUL(handshake_client3[36:])

	fmt.Printf("result3 => %s %d\n", str3, plen3)

}
